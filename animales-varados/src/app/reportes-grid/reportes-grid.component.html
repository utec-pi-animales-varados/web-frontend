<div class="long-title">
  <h3>Reporte de Animales Varados</h3>
</div>
<app-map #map>Loading...</app-map>
<dx-data-grid
    #grid
    (onRowClick)="callData(grid.instance.getSelectedRowsData()[0].picturesURLs)"
    (onRowClick)="map.setCoordinates(grid.instance.getSelectedRowsData()[0].latitude, grid.instance.getSelectedRowsData()[0].longitude)"
    id="gridContainer"
    [dataSource]= jsonDataSource
    [showBorders]="true"
    keyExpr="id"
    [hoverStateEnabled]="true"
    [selectedRowKeys]="[]">
    <dxo-selection mode="single"></dxo-selection>

    <dxo-filter-panel [visible]="true"></dxo-filter-panel>
    <dxo-filter-row [visible]="true"></dxo-filter-row>

    <dxo-group-panel [visible]="true"></dxo-group-panel>
    <dxo-grouping [autoExpandAll]="true"></dxo-grouping>
     
    <dxi-column caption="Datos del Reporte">
        <dxi-column
            dataField="date"
            dataType="datetime"
            caption="Fecha y Hora"
        ></dxi-column>
        <dxi-column
            dataField="latitude"
            dataType="number"
        ></dxi-column>
        <dxi-column
            dataField="longitude"
            dataType="number"
        ></dxi-column>
    </dxi-column>

    <dxi-column caption="Usuario">
        <dxi-column
            dataField="usuario.name"
            dataType="string"
            caption="Nombre"
        ></dxi-column>
        <dxi-column
            dataField="usuario.lastName"
            dataType="string"
            caption="Apellido"
        ></dxi-column>
        <dxi-column
            dataField="usuario.email"
            dataType="string"
            caption="Correo"
        ></dxi-column>
        <dxi-column
            dataField="usuario.telephone"
            dataType="string"
            caption="TelÃ©fono"
        ></dxi-column>
        <dxi-column
            dataField="usuario.mobilePhone"
            dataType="string"
            caption="Celular"
        ></dxi-column>
    </dxi-column>

    <dxi-column caption="Animal">
        <dxi-column
            dataField="animal.name"
            dataType="string"
            caption="Nombre"
        ></dxi-column>
        <dxi-column
            dataField="animal.color"
            dataType="string"
            caption="Color"
        ></dxi-column>
        <dxi-column
            dataField="longitudAnimal"
            dataType="number"
            caption="Longitud"
        ></dxi-column>
    </dxi-column>

    <dxo-export [enabled]="true" [allowExportSelectedData]="true"></dxo-export>
    
</dx-data-grid>

<div id="employeeInfo" *ngIf="grid.selectedRowKeys.length">
    <div class="widget-container">
        <dx-gallery #gallery
            id="gallery"
            [dataSource]= "images"
            [height]="300"
            [loop]="false"
            [showNavButtons]="true"
            [showIndicator]="true"
        ></dx-gallery>
    </div>
    <ul class="employeeNotes">
        <li *ngFor="let i of (grid.instance.getSelectedRowsData()[0].respuestas)">
        {{ i.pregunta.texto }}: <br> <b> {{i.textoRespuesta}} </b>
        </li>
    </ul>
</div>

